(function(b){var a=new function(){var d=this;d.cache={};d.width=ko.observable(b("#main").outerWidth());d.isPhone=ko.computed(function(){return d.width()<768});d.buttonWidth=ko.computed(function(){return d.isPhone()?"100%":(((d.width()-120)/4)+"px")});d.hasMailServer=ko.observable(true);d.hasJabberServer=ko.observable(true);d.refreshServers=function(){b.getJSON("../../admin/mailservers/list",function(i){d.hasMailServer(i&&i.length>0?true:false)}).error(MMONIT.error.json);b.getJSON("../../admin/jabberservers/list",function(i){d.hasJabberServer(i&&i.length>0?true:false)}).error(MMONIT.error.json)};var h=function(j){var i=this;i.ruleid=ko.observable(null);i.description=ko.observable("").extend({required:true,maxLength:255});i.active=ko.observable(false);i.rulerows=ko.observableArray().extend({rateLimit:50});i.actionrows=ko.observableArray().extend({rateLimit:50});i.editing=ko.observable(false);i.showTestResult=ko.observable(false);i.ajaxInProgress=ko.observable(false);i.mouseover=ko.observable(ISTABLET);i.modified=ko.observable(false);i.operator=ko.observableArray(Menu.JSONMapToMenu(a.cache.operator,[j.operator]));i.operator2label=function(k){return Menu.getSelectedNames(i.operator(),null)};i.repetition2label=function(k){return Menu.getSelectedNames(k.repetition(),"Never")};i.selectOperator=function(l,k){k.stopPropagation();i.modified(true);Menu.select(i.operator(),l.id)};i.addRuleRow=function(l,k,m){i.modified(true);if(l){m.stopPropagation();i.rulerows.splice(l,0,new g({rule:i}))}else{i.rulerows.push(new g({rule:i}))}};i.deleteRuleRow=function(k,l){l.stopPropagation();i.modified(true);i.rulerows.remove(k);if(i.rulerows().length==0){i.addRuleRow()}};i.addActionRow=function(k,l,m){i.modified(true);if(k){m.stopPropagation();i.actionrows.splice(k,0,new c({rule:i}))}else{i.actionrows.push(new c({rule:i}))}};i.deleteActionRow=function(k,l){l.stopPropagation();i.modified(true);i.actionrows.remove(k);if(i.actionrows().length==0){i.addActionRow()}};i.shouldShowWarning=function(m){var l=m.actionSelected();var k=false;switch(l){case"0":case"1":k=!a.hasMailServer();break;case"2":case"3":k=!a.hasJabberServer();break}return k};i.displayWarning=function(k,l){l.stopPropagation();b(l.currentTarget).tooltip("show")};i.hideWarning=function(k,l){l.stopPropagation();b(l.currentTarget).tooltip("hide")};i.clickWarning=function(l,m){m.stopPropagation();var k=l.actionSelected();switch(k){case"0":case"1":window.location="../../admin/alerts/?tab=mailTab";break;case"2":case"3":window.location="../../admin/alerts/?tab=jabberTab";break}};i.update=function(l,k){if(k){k.stopPropagation()}if(b.trim(i.description()).length>0){i.editing(false);i.modified(true);a.rules.expandedRow(i)}else{i.editing(true)}};i.edit=function(l,k){k.stopPropagation();i.editing(true)};i.stopEdit=function(){if(b.trim(i.description()).length>0){i.editing(false);i.update()}};i.toggleActive=function(k,l){l.stopPropagation();i.active(!i.active());if(i.ruleid()){b.ajax({url:"../../admin/alerts/updateactive",data:{id:i.ruleid(),active:i.active()?"1":"0"},type:"POST",error:MMONIT.error.json})}};i.toParams=function(){var k="id="+i.ruleid();k+="&description="+encodeURIComponent(i.description());k+="&operator="+Menu.getSelectedValues(i.operator(),"id")[0];k+="&rulerowscount="+i.rulerows().length;k+="&actionrowscount="+i.actionrows().length;b.each(i.rulerows(),function(m,l){k+=f(l.hostsSelected(),"&hosts"+m);k+=f(l.hostgroupsSelected(),"&hostgroups"+m);k+=f(l.servicesSelected(),"&services"+m);k+=f(l.servicegroupsSelected(),"&servicegroups"+m);k+=f(l.statesSelected(),"&states"+m);k+=f(l.eventsSelected(),"&events"+m)});b.each(i.actionrows(),function(m,l){var n=l.actionSelected();k+="&action"+m+"="+n;k+="&repetition"+m+"="+Menu.getSelectedValues(l.repetition(),"id")[0];switch(n){case"0":case"2":k+=f(l.usersSelected(),"&targets"+m);break;case"4":k+="&targets"+m+"="+encodeURIComponent(l.target());k+="&options"+m+"="+encodeURIComponent(l.option());break;default:k+="&targets"+m+"="+encodeURIComponent(l.target());break}});return k};i.check=function(){var k=true;if(!i.description.isValid()){b("#description input").focus();k=false}b.each(i.actionrows(),function(m,l){if(!l.target.isValid()){k=false}});return k};i.saveRule=function(k,l){l.stopPropagation();b(".callout").hide();if(i.check()){i.active(true);i.ajaxInProgress(true);b.ajax({url:"../../admin/alerts/create",data:i.toParams(),type:"POST",dataType:"json",timeout:30000,success:function(n,o,m){i.ajaxInProgress(false);i.ruleid(n.id);i.modified(false);a.rules.expandedRow(null);a.rules.createInProgress(false);b(".testoutput .input").text("");b(".popover").hide()},error:function(m,o,n){i.ajaxInProgress(false);MMONIT.error.json(m,o,n)}})}};i.updateRule=function(k,l){l.stopPropagation();b(".callout").hide();if(i.check()){i.ajaxInProgress(true);b.ajax({url:"../../admin/alerts/update",data:i.toParams(),type:"POST",timeout:30000,success:function(n,o,m){i.ajaxInProgress(false);i.modified(false);a.rules.expandedRow(null);a.rules.createInProgress(false);b(".testoutput .input").text("");b(".popover").hide()},error:function(m,o,n){i.ajaxInProgress(false);MMONIT.error.json(m,o,n)}})}};i.cancelRule=function(l,k){k.stopPropagation();b("#confirmRuleDelete").modal("hide")};i.deleteRule=function(l,k){k.stopPropagation();if(l.ruleid()){b.ajax({url:"../../admin/alerts/delete",data:{id:l.ruleid()},type:"POST",timeout:30000,success:function(n,o,m){b("#confirmRuleDelete").modal("hide");a.rules.createInProgress(false);a.rules.list.remove(l)},error:function(m,o,n){b("#confirmRuleDelete").modal("hide");MMONIT.error.json(m,o,n)}})}else{b("#confirmRuleDelete").modal("hide");a.rules.createInProgress(false);a.rules.list.remove(l)}};i.togglePanel=function(n,o){o.stopPropagation();var m=b(o.currentTarget);var l=m.parent().children(".popover");var k=l.is(":visible");b(".testoutput .input").text("");b(".popover").hide();if(k){return}l.show();var p=m.position();l.css({position:"absolute",top:(p.top-l.height()/2+10)+"px",left:(p.left+25)+"px"})};i.validate=function(){i.description.valueHasMutated()}};var g=function(i){var j=this;j.rule=i.rule;j.hosts=ko.observableArray();j.hostgroups=ko.observableArray();j.services=ko.observableArray();j.servicegroups=ko.observableArray();j.states=ko.observableArray();j.events=ko.observableArray();j.hostsSelected=ko.observableArray(i.hosts);j.hostgroupsSelected=ko.observableArray(i.hostgroups);j.servicesSelected=ko.observableArray(i.services);j.servicegroupsSelected=ko.observableArray(i.servicegroups);j.statesSelected=ko.observableArray(i.states);j.eventsSelected=ko.observableArray(i.events);j.toggleHostsMenu=function(k,l){if(!b(l.currentTarget).parent().children(".callout").is(":visible")){j.hosts(Menu.JSONMapToMenu(d.cache.hosts,j.hostsSelected()).sort(Menu.sortByName));j.hostgroups(Menu.JSONMapToMenu(d.cache.hostgroups,j.hostgroupsSelected()).sort(Menu.sortByName))}else{j.hosts.removeAll();j.hostgroups.removeAll()}TableView.callout.toggle(k,l)};j.toggleServicesMenu=function(k,m){if(!b(m.currentTarget).parent().children(".callout").is(":visible")){var l=f(j.hostsSelected(),"hostid")+f(j.hostgroupsSelected(),"hostgroupid");j.services(e(Menu.JSONToMenu(d.cache.services,j.servicesSelected(),"id"),"service","../../map/service?"+l));j.servicegroups(e(Menu.JSONToMenu(d.cache.servicegroups,j.servicegroupsSelected(),"id"),"servicegroup","../../map/servicegroup?"+l))}else{j.services.removeAll();j.servicegroups.removeAll()}TableView.callout.toggle(k,m)};j.toggleStatesMenu=function(k,l){if(!b(l.currentTarget).parent().children(".callout").is(":visible")){j.states(Menu.JSONMapToMenu(d.cache.states,j.statesSelected()))}else{j.states.removeAll()}TableView.callout.toggle(k,l)};j.toggleEventsMenu=function(k,n){if(!b(n.currentTarget).parent().children(".callout").is(":visible")){var l=[];var m="";b.each(j.servicesSelected(),function(s,q){for(var r=0;r<d.cache.services.length;r++){var o=d.cache.services[r];if(o.id==q){for(var p=0;p<o.typeid.length;p++){if(l.indexOf(o.typeid[p])===-1){l.push(o.typeid[p]);m+=(m.length?"&":"")+"servicetypeid="+o.typeid[p]}}break}}});j.events(e(Menu.JSONToMenu(d.cache.events,j.eventsSelected(),"id"),"event","../../map/event?"+m))}else{j.events.removeAll()}TableView.callout.toggle(k,n)};j.hosts2label=ko.computed(function(){if(j.hostsSelected().length){var k="";b.each(j.hostsSelected(),function(m,l){k+=(k.length?", ":"")+d.cache.hosts[l]});return"Host "+k}else{if(j.hostgroupsSelected().length){var k="";b.each(j.hostgroupsSelected(),function(m,l){k+=(k.length?", ":"")+d.cache.hostgroups[l]});return"Hostgroup "+k}else{return"Any Host"}}});j.services2label=ko.computed(function(){if(j.servicesSelected().length){var k="";b.each(j.servicesSelected(),function(m,l){for(var m=0;m<d.cache.services.length;m++){if(d.cache.services[m].id==l){k+=(k.length?", ":"")+d.cache.services[m].name;break}}});return"Service "+k}else{if(j.servicegroupsSelected().length){var k="";b.each(j.servicegroupsSelected(),function(m,l){for(var m=0;m<d.cache.servicegroups.length;m++){if(d.cache.servicegroups[m].id==l){k+=(k.length?", ":"")+d.cache.servicegroups[m].name;break}}});return"Servicegroup "+k}else{return"Any Service"}}});j.states2label=ko.computed(function(){var k="";b.each(j.statesSelected(),function(m,l){k+=(k.length?", ":"")+d.cache.states[l]});return k.length?k:"Any State"});j.events2label=ko.computed(function(){var k="";b.each(j.eventsSelected(),function(m,l){for(var m=0;m<d.cache.events.length;m++){if(d.cache.events[m].id==l){k+=(k.length?", ":"")+d.cache.events[m].name;break}}});return k.length?k:"Any Event"});j.hostViewController=new TableViewListController();j.serviceViewController=new TableViewListController();j.hostQuery=ko.observable("").extend({rateLimit:{timeout:300,method:"notifyWhenChangesStop"}});j.hostQuery.subscribe(function(k){Menu.search(j.hosts(),k)});j.shouldShowHostSearch=ko.observable(false);j.toggleShowHostSearch=function(l,m){m.stopPropagation();var k=j.shouldShowHostSearch();if(k){Menu.activateAll(j.hosts());j.hostQuery("")}j.shouldShowHostSearch(!k)};j.serviceQuery=ko.observable("").extend({rateLimit:{timeout:300,method:"notifyWhenChangesStop"}});j.serviceQuery.subscribe(function(k){Menu.search(j.services(),k)});j.shouldShowServiceSearch=ko.observable(false);j.toggleShowServiceSearch=function(l,m){m.stopPropagation();var k=j.shouldShowServiceSearch();if(k){Menu.activateAll(j.services());j.serviceQuery("")}j.shouldShowServiceSearch(!k)};j.selectHost=function(m,l){l.stopPropagation();j.rule.modified(true);var k=m.selected();Menu.unselectAll(j.hosts());Menu.unselectAll(j.hostgroups());m.selected(!k);j.hostsSelected.removeAll();j.hostgroupsSelected.removeAll();j.hostsSelected(Menu.getSelectedValues(j.hosts(),"id"))};j.selectHostGroup=function(m,l){l.stopPropagation();j.rule.modified(true);var k=m.selected();Menu.unselectAll(j.hosts());Menu.unselectAll(j.hostgroups());m.selected(!k);j.hostsSelected.removeAll();j.hostgroupsSelected.removeAll();j.hostgroupsSelected(Menu.getSelectedValues(j.hostgroups(),"id"))};j.selectService=function(l,k){k.stopPropagation();j.rule.modified(true);Menu.unselectAll(j.servicegroups());l.selected(!l.selected());j.servicegroupsSelected.removeAll();j.servicesSelected(Menu.getSelectedValues(j.services(),"id"))};j.selectAllServices=function(k,l){l.stopPropagation();j.rule.modified(true);Menu.unselectAll(j.servicegroups());Menu.toggleSelection(j.services(),k,l);j.servicegroupsSelected.removeAll();j.servicesSelected(Menu.getSelectedValues(j.services(),"id"))};j.selectServiceGroup=function(l,k){k.stopPropagation();j.rule.modified(true);Menu.unselectAll(j.services());l.selected(!l.selected());j.servicesSelected.removeAll();j.servicegroupsSelected(Menu.getSelectedValues(j.servicegroups(),"id"))};j.selectAllServiceGroups=function(k,l){l.stopPropagation();j.rule.modified(true);Menu.unselectAll(j.services());Menu.toggleSelection(j.servicegroups(),k,l);j.servicesSelected.removeAll();j.servicegroupsSelected(Menu.getSelectedValues(j.servicegroups(),"id"))};j.selectState=function(l,k){k.stopPropagation();j.rule.modified(true);l.selected(!l.selected());j.statesSelected(Menu.getSelectedValues(j.states(),"id"))};j.selectEvent=function(l,k){k.stopPropagation();j.rule.modified(true);l.selected(!l.selected());j.eventsSelected(Menu.getSelectedValues(j.events(),"id"))};j.toggleSelection=function(n,k,l,m){m.stopPropagation();j.rule.modified(true);Menu.toggleSelection(n(),l,m);k(Menu.getSelectedValues(n(),"id"))};j.controlboxEnabled=ko.observable(ISTABLET);j.enableControlbox=function(k,l){l.stopPropagation();if(!ISTABLET){j.controlboxEnabled(true)}};j.disableControlbox=function(k,l){l.stopPropagation();if(!ISTABLET){j.controlboxEnabled(false)}}};var c=function(i){var j=this;j.rule=i.rule;function k(m,n,l){j.actionSelected(m);switch(m){case"0":j.usersSelected(n?n:[]);j.target("");j.option("");Menu.select(j.repetition(),"0");break;case"2":j.usersSelected(n?n:[]);j.target("");j.option("");Menu.select(j.repetition(),"0");break;case"4":j.usersSelected([]);j.target(n?n[0]:"");j.option(l?l[0].value:"PATH=/bin:/usr/bin:/usr/local/bin:/opt/csw/bin:/usr/sfw/bin;");Menu.select(j.repetition(),"0");break;default:j.usersSelected([]);j.target(n?n[0]:"");j.option("");Menu.select(j.repetition(),"0");break}}j.actions=ko.observableArray();j.users=ko.observableArray();j.actionSelected=ko.observable();j.usersSelected=ko.observableArray();j.target=ko.observable().extend({checkTarget:j});j.option=ko.observable();j.repetition=ko.observableArray(Menu.JSONToMenu([{id:"0",name:"Never"},{id:"300",name:"Every 5 minutes"},{id:"900",name:"Every 15 minutes"},{id:"1800",name:"Every 30 minutes"},{id:"3600",name:"Every hour"},{id:"86400",name:"Every day"},]));if(i.action){k(i.action,i.target,i.option);Menu.select(j.repetition(),i.repetition)}else{k("0");Menu.select(j.repetition(),"0")}j.target.subscribe(function(l){j.rule.modified(true)});j.option.subscribe(function(l){j.rule.modified(true)});j.toggleActionMenu=function(l,m){if(!b(m.currentTarget).parent().children(".callout").is(":visible")){j.actions(Menu.JSONMapToMenu(d.cache.actions,[j.actionSelected()]))}else{j.actions.removeAll()}TableView.callout.toggle(l,m)};j.toggleUsersMenu=function(l,n){if(!b(n.currentTarget).parent().children(".callout").is(":visible")){j.users(Menu.JSONToMenu(d.cache.users,j.usersSelected(),"name"));var m=j.actionSelected();if(m==0||m==2){b.each(j.users(),function(o,p){if((m==0&&(!p.mail||p.mail==""))||(m==2&&(!p.im||p.im==""))){p.disabled(true)}})}}else{j.users.removeAll()}TableView.callout.toggle(l,n)};j.selectAction=function(l){if(j.actionSelected()!=l.id){j.rule.modified(true);Menu.select(j.actions(),l.id);k(l.id)}};j.selectUser=function(l){if(!l.disabled()){j.rule.modified(true);l.selected(!l.selected());j.usersSelected(Menu.getSelectedValues(j.users(),"name"))}};j.selectRepetition=function(l){j.rule.modified(true);Menu.select(j.repetition(),l.id)};j.toggleSelection=function(o,l,m,n){n.stopPropagation();j.rule.modified(true);Menu.toggleSelection(o(),m,n);l(Menu.getSelectedValues(o(),"name"))};j.action2label=ko.computed(function(){return d.cache.actions[j.actionSelected()]});j.user2label=ko.computed(function(){var l="";b.each(j.usersSelected(),function(n,m){for(var n=0;n<d.cache.users.length;n++){if(d.cache.users[n].name==m){l+=(l.length?", ":"")+d.cache.users[n].name;break}}});return l.length?l:"All Users"});j.testMessage=function(p,r){r.stopPropagation();if(!p.testInProgress()){p.testInProgress(true);var q=b(r.currentTarget);var l=q.parents(".popover");var t=l.find(".testoutput");var u=t.find(".input");var o=p.actionSelected();u.text("Processing...");var n="action="+o;switch(o){case"0":if(!p.usersSelected().length){b.each(d.cache.users,function(x,w){if(w.mail&&w.mail!=""){n+="&targets="+encodeURIComponent(w.mail)}})}else{b.each(p.usersSelected(),function(y,x){for(var y=0;y<d.cache.users.length;y++){var w=d.cache.users[y];if(w.name===x){if(w.mail&&w.mail!=""){n+="&targets="+encodeURIComponent(w.mail)}break}}})}break;case"1":case"3":if(!p.target.isValid()){var m=l.parents(".actionrow");var s=m.find(".input.address");s.focus();u.text("Please enter valid address");p.testInProgress(false);return}else{n+="&targets="+encodeURIComponent(p.target())}break;case"2":if(!p.usersSelected().length){b.each(d.cache.users,function(x,w){if(w.im&&w.im!=""){n+="&targets="+encodeURIComponent(w.im)}})}else{b.each(p.usersSelected(),function(y,x){for(var y=0;y<d.cache.users.length;y++){var w=d.cache.users[y];if(w.name===x){if(w.im&&w.im!=""){n+="&targets="+encodeURIComponent(w.im)}break}}})}break;default:n+="&targets="+encodeURIComponent(p.target());break}b.post("../../admin/alerts/testmessage",n,function(v){u.text(v);p.testInProgress(false)}).error(function(v,x,w){MMONIT.error.json(v,x,w);p.testInProgress(false)})}};j.testProgram=function(q,s){s.stopPropagation();if(!q.testInProgress()){q.testInProgress(true);var o=b(s.currentTarget);var m=o.parents(".popover");var r=m.find(".testinput");var l=r.find(".input");var p=m.find(".testoutput");var n=p.find(".input");if(!q.target.isValid()){l.focus();n.text("Please specify the program to execute");q.testInProgress(false)}else{n.text("Processing...");b.post("../../admin/alerts/testprogram",{environment:q.option(),program:q.target()},function(t){n.text(t);q.testInProgress(false)}).error(function(t,v,u){MMONIT.error.json(t,v,u);q.testInProgress(false)})}}};j.controlboxEnabled=ko.observable(ISTABLET);j.enableControlbox=function(l,m){m.stopPropagation();if(!ISTABLET){j.controlboxEnabled(true)}};j.disableControlbox=function(l,m){m.stopPropagation();if(!ISTABLET){j.controlboxEnabled(false)}};j.testInProgress=ko.observable(false)};d.rules={list:ko.observableArray().extend({rateLimit:50}),rule:ko.observable(),expandedRow:ko.observable(null),createInProgress:ko.observable(false),toggleExpand:function(j,i){i.stopPropagation();d.rules.expandedRow((d.rules.expandedRow()!==j)?j:null)},isExpanded:function(i){return(i===d.rules.expandedRow())},enableMouseover:function(j,i){i.stopPropagation();if(!ISTABLET){j.mouseover(true)}},disableMouseover:function(j,i){i.stopPropagation();if(!ISTABLET){j.mouseover(false)}},confirmDelete:function(j,i){i.stopPropagation();d.rules.rule(j);b("#confirmRuleDelete").modal("show")},add:function(j,k){k.stopPropagation();if(!d.rules.createInProgress()){d.rules.createInProgress(true);d.rules.expandedRow(null);var i=new h({operator:"0"});i.editing(true);i.addRuleRow();i.addActionRow();d.rules.list.push(i)}}};d.handleRuleRowAfterRender=function(j,i){b.each(j,function(l,k){if(k.nodeType===1){i.hostViewController.init(b(k).find(".host.tableViewMenu"));i.serviceViewController.init(b(k).find(".service.tableViewMenu"))}})};function f(k,j){var i="";b.each(k,function(m,l){i+=j+"="+encodeURIComponent(l)});return i}function e(n,k,i){var j=b.ajax({url:i,dataType:"json",timeout:30000,async:false,error:MMONIT.error.json});if(j.state()!="resolved"){MMONIT.error.json(j);return[]}else{var l=b.parseJSON(j.responseText);var m=[];b.each(l.map[k],function(p,o){m.push(o.id)});b.each(n,function(p,o){o.active(m.indexOf(o.id)==-1?false:true)});return n}}d.refreshServers();d.spinner=setTimeout("$('.spinner').show()",300);b.ajax({url:"../../map",dataType:"json",async:false,timeout:30000,success:function(j,k,i){d.cache.operator=j.map.id.operator;d.cache.hosts=j.map.id.host;d.cache.hostgroups=j.map.id.hostgroup;d.cache.services=j.map.service;d.cache.servicegroups=j.map.servicegroup;d.cache.states=j.map.id.statetype;d.cache.events=j.map.event.sort(Menu.sortByName);d.cache.actions=j.map.id.action;d.cache.users=j.map.user;b.getJSON("../../admin/alerts/list",function(n){for(var l=0;l<n.length;l++){var o=n[l];var m=new h({operator:o.operator.toString()});m.ruleid(o.id);m.description(o.description);m.active(o.active);b.each(o.rulerows,function(q,p){m.rulerows.push(new g({rule:m,hosts:p.hosts,hostgroups:p.hostgroups,services:p.services,servicegroups:p.servicegroups,states:p.states,events:p.events}))});b.each(o.actionrows,function(q,p){m.actionrows.push(new c({rule:m,action:p.action,repetition:p.repetition,target:p.targets,option:p.options}))});d.rules.list.push(m)}}).error(MMONIT.error.json);clearTimeout(d.spinner);b(".spinner").hide()},error:MMONIT.error.json})};ko.validation.rules.checkTarget={validator:function(d,c){switch(c.actionSelected()){case"1":case"3":if(!d||d==""||d.search(/^([^@ ]+@){1}([-a-zA-Z0-9]+(\.)?)+([a-zA-Z]{2,})?$/i)==-1){return false}break;case"4":if(!d){return false}break;default:break}return true},message:"Invalid target"};ko.validation.registerExtenders();ko.validation.init({insertMessages:false,decorateElement:true,errorElementClass:"error"},true);ko.applyBindings(a,document.getElementById("rulesTab"));b('#tabs a[href="#rulesTab"]').on("vclick",function(c){a.refreshServers()});b(window).on("resize orientationchange",function(d){var c=b("#main").outerWidth();if(c!=a.width()){b(".callout").hide();a.width(b("#main").outerWidth())}})})(jQuery);